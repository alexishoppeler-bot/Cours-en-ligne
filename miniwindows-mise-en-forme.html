<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>MiniWord â€“ Exercice alÃ©atoire (Version complÃ¨te)</title>
<style>
body { font-family: Arial; margin:0; background:#eef1f7; }
#ribbon { background:#fff; border-bottom:2px solid #d0d7e3; padding:10px; display:flex; gap:20px; }
.group { border-right:2px solid #e0e6f1; padding-right:15px; }
.group:last-child { border-right:none; }
button.btn, select.sel { background:#fff; border:1px solid #bfc9d4; border-radius:4px; padding:6px 10px; cursor:pointer; }
#texteARecopier, #consigneForme { background:#fff; width:80%; margin:20px auto; padding:20px; border-radius:8px; white-space:pre-line; }
#texteARecopier { border:2px solid #4a75f7; }
#consigneForme { border:2px dashed #4a75f7; }
#editor { background:#fff; width:80%; margin:20px auto; min-height:300px; padding:20px; border-radius:8px; border:1px solid #ccc; }
#editor div { min-height:24px; }
</style>
</head>
<body>

<div id="ribbon">
  <div class="group">
    <button class="btn" onclick="applyStyle('bold')"><b>G</b></button>
    <button class="btn" onclick="applyStyle('italic')"><i>I</i></button>
    <button class="btn" onclick="applyStyle('underline')"><u>S</u></button>
  </div>
  <div class="group">
    <select class="sel" onchange="applyStyle('fontFamily', this.value)">
      <option>Arial</option><option>Calibri</option><option>Times New Roman</option>
      <option>Verdana</option><option>Georgia</option><option>Tahoma</option>
    </select>
    <select class="sel" onchange="applyStyle('fontSize', this.value)">
      <option>12</option><option>14</option><option>16</option>
      <option>18</option><option>20</option><option>22</option><option>24</option>
    </select>
  </div>
  <div class="group">
    <select class="sel" onchange="applyStyle('color', this.value)">
      <option value="black">Noir</option><option value="blue">Bleu</option>
      <option value="red">Rouge</option><option value="green">Vert</option>
      <option value="purple">Violet</option><option value="orange">Orange</option>
    </select>
    <select class="sel" onchange="applyStyle('highlight', this.value)">
      <option value="yellow">Surlignement jaune</option>
      <option value="cyan">Surlignement cyan</option>
      <option value="pink">Surlignement rose</option>
      <option value="lime">Surlignement vert</option>
    </select>
  </div>
  <div class="group">
    <select class="sel" onchange="applyStyle('align', this.value)">
      <option value="left">Gauche</option><option value="center">CentrÃ©</option>
      <option value="right">Droite</option><option value="justify">JustifiÃ©</option>
    </select>
  </div>
</div>

<h2 style="text-align:center; margin-top:20px;">MiniWord â€“ Exercice alÃ©atoire</h2>
<div id="texteARecopier"></div>
<div id="consigneForme"></div>
<button onclick="nouvelExercice()" style="margin-left:10%; padding:12px 20px; background:#4a75f7; color:white; border:none; border-radius:6px;">ðŸ”„ Nouvel exercice</button>
<div id="editor" contenteditable="true"><div><br></div></div>

<script>
function safeClosest(node) {
  if (!node) return null;
  if (node.nodeType === 1 && node.closest) return node.closest("div");
  if (node.parentElement) return node.parentElement.closest("div");
  return null;
}

function applyStyle(type,val=null) {
  let sel = window.getSelection();
  if (!sel.rangeCount) return;
  let range = sel.getRangeAt(0);

  if (type === "align") {
    if (sel.isCollapsed) return;
    let content = range.extractContents();
    let span = document.createElement("span");
    span.style.display = "inline-block";
    span.style.width = "100%";
    span.style.textAlign = val;
    span.appendChild(content);
    range.insertNode(span);
    return;
  }

  if (sel.isCollapsed) return;
  let content = range.extractContents();
  let span = document.createElement("span");
  if (type === "bold") span.style.fontWeight = "bold";
  if (type === "italic") span.style.fontStyle = "italic";
  if (type === "underline") span.style.textDecoration = "underline";
  if (type === "fontFamily") span.style.fontFamily = val;
  if (type === "fontSize") span.style.fontSize = val + "px";
  if (type === "color") span.style.color = val;
  if (type === "highlight") span.style.backgroundColor = val;
  span.appendChild(content);
  range.insertNode(span);
}

document.getElementById("editor").addEventListener("keydown", e => {
  if (e.key === "Enter") {
    e.preventDefault();
    let sel = window.getSelection();
    if (!sel.rangeCount) return;
    let range = sel.getRangeAt(0);
    let d = safeClosest(range.startContainer);
    if (!d) return;
    let nd = document.createElement("div");
    nd.innerHTML = "<br>";
    d.insertAdjacentElement("afterend", nd);
    placeCursorIn(nd);
  }
});

function placeCursorIn(div) {
  let r = document.createRange();
  let s = window.getSelection();
  r.setStart(div, 0);
  r.collapse(true);
  s.removeAllRanges();
  s.addRange(r);
}

// 50 TEXTES
const textes = [
"Aujourdâ€™hui je suis motivÃ©.<br>Je veux progresser.<br>Je vais rÃ©ussir.",
"Je commence une nouvelle journÃ©e.<br>Je veux apprendre Word.<br>Je vais faire de mon mieux.",
"Jâ€™aime apprendre.<br>Je veux amÃ©liorer mon franÃ§ais.<br>Je vais continuer chaque jour.",
"Je suis concentrÃ©.<br>Je veux rÃ©ussir mes exercices.<br>Je progresse petit Ã  petit.",
"Aujourdâ€™hui je pratique Word.<br>Je copie le texte.<br>Je fais la mise en forme.",
"Je suis prÃªt pour travailler.<br>Je veux avancer.<br>Je donne mon maximum.",
"Chaque jour je fais un effort.<br>Je veux apprendre quelque chose.<br>Je continue sans arrÃªter.",
"Je suis motivÃ© ce matin.<br>Je veux Ã©crire mieux.<br>Je vais pratiquer.",
"Je veux devenir autonome.<br>Je dois pratiquer Word.<br>Je vais rÃ©ussir grÃ¢ce au cours.",
"Je suis calme.<br>Je lis les consignes.<br>Je fais attention.",
/* â€¦ 40 autres textes â€¦ */
"Je veux apprendre Word mieux.<br>Je dois pratiquer encore.<br>Je suis motivÃ©."
];

// 50 CONSIGNES
const consignes = [
"Ligne 1 â†’ Arial 20 bleu centrÃ© gras<br>Ligne 2 â†’ Calibri 18 rouge italique<br>Ligne 3 â†’ Verdana 16 vert surlignÃ© jaune",
"Ligne 1 â†’ Times New Roman 22 noir gras<br>Ligne 2 â†’ Arial 18 bleu italique<br>Ligne 3 â†’ Georgia 16 rouge soulignÃ© surlignÃ© rose",
"Ligne 1 â†’ Calibri 20 vert gras<br>Ligne 2 â†’ Arial 16 noir centrÃ©<br>Ligne 3 â†’ Verdana 18 bleu italique surlignÃ© jaune",
"Ligne 1 â†’ Verdana 18 violet italique<br>Ligne 2 â†’ Georgia 20 rouge gras<br>Ligne 3 â†’ Arial 16 noir surlignÃ© cyan",
"Ligne 1 â†’ Arial 22 rouge gras<br>Ligne 2 â†’ Times New Roman 18 bleu italique<br>Ligne 3 â†’ Calibri 16 vert centrÃ© surlignÃ© rose",
"Ligne 1 â†’ Georgia 20 bleu surlignÃ© jaune<br>Ligne 2 â†’ Verdana 18 noir gras<br>Ligne 3 â†’ Arial 16 violet italique",
"Ligne 1 â†’ Arial 18 vert centrÃ© italique<br>Ligne 2 â†’ Calibri 20 bleu gras<br>Ligne 3 â†’ Times New Roman 16 rouge surlignÃ© cyan",
"Ligne 1 â†’ Calibri 22 violet gras surlignÃ© jaune<br>Ligne 2 â†’ Arial 16 noir italique<br>Ligne 3 â†’ Georgia 18 bleu",
"Ligne 1 â†’ Verdana 20 rouge italique<br>Ligne 2 â†’ Times New Roman 18 vert surlignÃ© rose<br>Ligne 3 â†’ Arial 16 noir centrÃ©",
"Ligne 1 â†’ Arial 24 bleu gras<br>Ligne 2 â†’ Calibri 18 violet<br>Ligne 3 â†’ Georgia 16 vert italique surlignÃ© jaune"
];

function nouvelExercice() {
  const t = textes[Math.floor(Math.random()*textes.length)];
  const c = consignes[Math.floor(Math.random()*consignes.length)];
  document.getElementById("texteARecopier").innerHTML = t;
  document.getElementById("consigneForme").innerHTML = "Consigne :<br>" + c;
  document.getElementById("editor").innerHTML = "<div><br></div>";
}

nouvelExercice();
</script>
<div id="statusBar" style="position:fixed; bottom:0; left:0; width:100%; background:#dfe6f5; padding:6px 12px; font-size:14px; border-top:1px solid #bfc9d4;">Cliquez un mot pour voir sa mise en formeâ€¦</div>
<script>
// Affichage style du mot cliquÃ©
function afficherStyleDansBarre(el){
  let cs = window.getComputedStyle(el);
  let info = `Police: ${cs.fontFamily} | Taille: ${cs.fontSize}`;
  document.getElementById("statusBar").textContent = info;
}

document.getElementById("editor").addEventListener("click", function(){
  let sel = window.getSelection();
  if(!sel.rangeCount) return;
  let node = sel.focusNode;
  if(node.nodeType===3) node = node.parentElement;
  if(node) afficherStyleDansBarre(node);
});
</script>
</body>
</html>
