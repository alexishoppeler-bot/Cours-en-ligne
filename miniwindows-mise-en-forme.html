<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Mise en forme ‚Äì Exercices Word</title>

<style>
body{
  font-family:Calibri, Arial;
  margin:0;
  background:#eef1f7;
}

h1{text-align:center;margin:16px}

/* CONTENEURS */
.box{
  width:80%;
  margin:12px auto;
  background:#fff;
  padding:16px;
  border-radius:8px;
}
#modele{border:2px solid #4a75f7}
#consigne{border:2px dashed #4a75f7}

/* BARRE WORD */
#toolbar{
  width:80%;
  margin:0 auto;
  background:#f9f9fb;
  border:1px solid #c6ccd8;
  border-bottom:none;
  border-radius:8px 8px 0 0;
  padding:6px;
  display:flex;
  gap:6px;
}
.btn{
  min-width:34px;
  height:30px;
  border:1px solid #c6ccd8;
  background:#fff;
  border-radius:3px;
  cursor:pointer;
  font-size:14px;
}
.btn:hover{background:#e6edff}
.btn:active{background:#cddcff}

.sel{
  height:30px;
  border:1px solid #c6ccd8;
  background:#fff;
}

/* EDITEUR */
#editor{
  width:80%;
  margin:0 auto 16px auto;
  background:#fff;
  border:1px solid #c6ccd8;
  border-top:none;
  border-radius:0 0 8px 8px;
  min-height:260px;
  padding:12px;
}
#editor div{min-height:22px}
mark{background:#fff59d;padding:0 2px}

/* NAV */
.nav{
  text-align:center;
  margin-bottom:20px;
}
</style>
</head>

<body>

<h1>üìù Mise en forme du texte</h1>

<div class="box" id="modele"></div>
<div class="box" id="consigne"></div>

<!-- BARRE WORD -->
<div id="toolbar">
  <button class="btn" onclick="cmd('bold')"><b>B</b></button>
  <button class="btn" onclick="cmd('italic')"><i>I</i></button>
  <button class="btn" onclick="cmd('underline')"><u>U</u></button>
  <button class="btn" onclick="cmd('highlight')">üñç</button>

  <select class="sel" onchange="cmd('color',this.value)">
    <option value="black">Noir</option>
    <option value="blue">Bleu</option>
    <option value="red">Rouge</option>
    <option value="green">Vert</option>
  </select>

  <button class="btn" onclick="cmd('align','left')">‚¨Ö</button>
  <button class="btn" onclick="cmd('align','center')">‚á§‚á•</button>
  <button class="btn" onclick="cmd('align','right')">‚û°</button>
</div>

<!-- EDITEUR -->
<div id="editor" contenteditable="true"><div><br></div></div>

<div class="nav">
  <button class="btn" onclick="prev()">‚¨Ö Exercice pr√©c√©dent</button>
  <button class="btn" onclick="next()">Exercice suivant ‚û°</button>
</div>

<script>
/* ---------- OUTILS ---------- */
function cmd(type,val=null){
  let s=window.getSelection();
  if(!s.rangeCount||s.isCollapsed)return;
  let r=s.getRangeAt(0);
  let c=r.extractContents();
  let el;

  if(type==="highlight"){
    el=document.createElement("mark");
  }else{
    el=document.createElement("span");
    if(type==="bold") el.style.fontWeight="bold";
    if(type==="italic") el.style.fontStyle="italic";
    if(type==="underline") el.style.textDecoration="underline";
    if(type==="color") el.style.color=val;
    if(type==="align"){
      el.style.display="block";
      el.style.textAlign=val;
    }
  }
  el.appendChild(c);
  r.insertNode(el);
  save();
}

/* ---------- DONN√âES ---------- */
const exos=[
{t:"Je m‚Äôappelle Alex.<br>Je cherche un emploi.<br>Je suis motiv√©.",
 c:"Ligne 1 : gras<br>Ligne 2 : italique<br>Ligne 3 : normal"},
{t:"Je travaille en √©quipe.<br>Je respecte les consignes.<br>Je suis ponctuel.",
 c:"Ligne 1 : bleu<br>Ligne 2 : rouge<br>Ligne 3 : vert"},
{t:"Je pr√©pare mon CV.<br>J‚Äôenvoie ma candidature.<br>J‚Äôattends une r√©ponse.",
 c:"Ligne 1 : gras + bleu<br>Ligne 2 : italique<br>Ligne 3 : surlign√©"},
{t:"Je commence un nouveau travail.<br>Je suis concentr√©.<br>Je progresse.",
 c:"Ligne 1 : centr√©<br>Ligne 2 : gauche<br>Ligne 3 : droite"},
{t:"Je suis autonome.<br>Je sais utiliser Word.<br>Je continue √† apprendre.",
 c:"Ligne 1 : rouge + centr√©<br>Ligne 2 : bleu + gauche<br>Ligne 3 : surlign√©"},
{t:"Je lis les consignes.<br>Je fais attention.<br>Je travaille correctement.",
 c:"Ligne 1 : soulign√©<br>Ligne 2 : vert<br>Ligne 3 : centr√©"},
{t:"Je pr√©pare mes documents.<br>Je sauvegarde mon travail.<br>Je ferme Word.",
 c:"Ligne 1 : gras<br>Ligne 2 : italique<br>Ligne 3 : droite"},
{t:"Je respecte les d√©lais.<br>Je suis organis√©.<br>Je suis efficace.",
 c:"Ligne 1 : bleu<br>Ligne 2 : centr√©<br>Ligne 3 : surlign√©"},
{t:"Je commence √† 8 heures.<br>Je fais une pause.<br>Je termine √† 17 heures.",
 c:"Ligne 1 : gauche<br>Ligne 2 : centr√©<br>Ligne 3 : droite"},
{t:"Je progresse chaque jour.<br>Je pratique Word.<br>Je deviens autonome.",
 c:"Ligne 1 : gras + rouge<br>Ligne 2 : italique + bleu<br>Ligne 3 : surlign√©"}
];

let i=0;

/* ---------- CHARGER ---------- */
function load(){
  modele.innerHTML="<b>Texte √† recopier :</b><br><br>"+exos[i].t;
  consigne.innerHTML="<b>Consigne :</b><br><br>"+exos[i].c;
  editor.innerHTML=localStorage.getItem("exo_"+i)||"<div><br></div>";
}
load();

/* ---------- SAUVEGARDE AUTO ---------- */
function save(){
  localStorage.setItem("exo_"+i,editor.innerHTML);
}
editor.addEventListener("input",save);

/* ---------- NAV ---------- */
function next(){ if(i<exos.length-1){ i++; load(); } }
function prev(){ if(i>0){ i--; load(); } }

/* ---------- ENTR√âE PROPRE ---------- */
editor.addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    e.preventDefault();
    let d=document.createElement("div");
    d.innerHTML="<br>";
    window.getSelection().getRangeAt(0).startContainer.parentElement.after(d);
    save();
  }
});
</script>

</body>
</html>
