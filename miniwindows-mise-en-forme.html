<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>MiniWord ‚Äì Exercice al√©atoire</title>

<style>
body{
  font-family:Arial;
  margin:0;
  background:#eef1f7;
}

/* RUBAN */
#ribbon{
  background:#fff;
  border-bottom:2px solid #d0d7e3;
  padding:8px;
  display:flex;
  gap:18px;
}

.group{
  display:flex;
  gap:6px;
  padding-right:14px;
  border-right:2px solid #e0e6f1;
}
.group:last-child{border:none}

/* BOUTONS WORD-LIKE */
button.btn{
  background:#f8f9fb;
  border:1px solid #c6cdd9;
  border-radius:4px;
  padding:6px 10px;
  cursor:pointer;
  font-size:14px;
}
button.btn:hover{background:#e9eef6}

select.sel{
  background:#f8f9fb;
  border:1px solid #c6cdd9;
  border-radius:4px;
  padding:6px;
}

/* ZONES */
h2{text-align:center;margin-top:20px}

#texteARecopier,#consigneForme,#editor{
  background:#fff;
  width:80%;
  margin:15px auto;
  padding:20px;
  border-radius:8px;
}

#texteARecopier{border:2px solid #4a75f7}
#consigneForme{border:2px dashed #4a75f7}
#editor{
  min-height:320px;
  border:1px solid #ccc;
}
#editor div{min-height:22px}

/* STATUS BAR */
#statusBar{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  background:#dfe6f5;
  padding:6px 12px;
  font-size:14px;
  border-top:1px solid #bfc9d4;
}
</style>
</head>

<body>

<!-- RUBAN -->
<div id="ribbon">
  <div class="group">
    <button class="btn" onclick="applyStyle('bold')">üÖ±</button>
    <button class="btn" onclick="applyStyle('italic')"><i>I</i></button>
    <button class="btn" onclick="applyStyle('underline')"><u>S</u></button>
    <button class="btn" onclick="applyStyle('highlight','yellow')">üñç</button>
  </div>

  <div class="group">
    <select class="sel" onchange="applyStyle('fontFamily',this.value)">
      <option>Arial</option>
      <option>Calibri</option>
      <option>Verdana</option>
      <option>Georgia</option>
      <option>Times New Roman</option>
    </select>

    <select class="sel" onchange="applyStyle('fontSize',this.value)">
      <option>14</option><option>16</option><option>18</option>
      <option>20</option><option>22</option><option>24</option>
    </select>
  </div>

  <div class="group">
    <select class="sel" onchange="applyStyle('color',this.value)">
      <option value="black">Noir</option>
      <option value="blue">Bleu</option>
      <option value="red">Rouge</option>
      <option value="green">Vert</option>
      <option value="purple">Violet</option>
    </select>

    <select class="sel" onchange="applyStyle('align',this.value)">
      <option value="left">Gauche</option>
      <option value="center">Centr√©</option>
      <option value="right">Droite</option>
    </select>
  </div>
</div>

<h2>MiniWord ‚Äì Copier et mettre en forme</h2>

<div id="texteARecopier"></div>
<div id="consigneForme"></div>

<button onclick="nouvelExercice()" style="margin-left:10%;padding:10px 20px;background:#4a75f7;color:#fff;border:none;border-radius:6px">
üîÑ Nouvel exercice
</button>

<div id="editor" contenteditable="true">
  <div><br></div>
</div>

<div id="statusBar">Clique sur un mot pour voir sa mise en forme</div>

<script>
// STYLE APPLICATION (STABLE)
function applyStyle(type,val=null){
  let sel=window.getSelection();
  if(!sel.rangeCount||sel.isCollapsed)return;

  let range=sel.getRangeAt(0);
  let content=range.extractContents();
  let el;

  if(type==="highlight"){
    el=document.createElement("mark");
    el.style.backgroundColor=val;
  }else{
    el=document.createElement("span");
    if(type==="bold") el.style.fontWeight="bold";
    if(type==="italic") el.style.fontStyle="italic";
    if(type==="underline") el.style.textDecoration="underline";
    if(type==="fontFamily") el.style.fontFamily=val;
    if(type==="fontSize") el.style.fontSize=val+"px";
    if(type==="color") el.style.color=val;
    if(type==="align"){
      el.style.display="block";
      el.style.textAlign=val;
    }
  }

  el.appendChild(content);
  range.insertNode(el);
}

// ENTR√âE STABLE
document.getElementById("editor").addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    e.preventDefault();
    let d=document.createElement("div");
    d.innerHTML="<br>";
    document.getSelection().getRangeAt(0).startContainer.parentElement.after(d);
    placeCursor(d);
  }
});

function placeCursor(el){
  let r=document.createRange();
  let s=window.getSelection();
  r.setStart(el,0);
  r.collapse(true);
  s.removeAllRanges();
  s.addRange(r);
}

// EXERCICES
const textes=[
"Aujourd‚Äôhui je suis motiv√©.<br>Je veux progresser.<br>Je vais r√©ussir.",
"Je commence une nouvelle journ√©e.<br>Je veux apprendre Word.<br>Je fais attention."
];

const consignes=[
"Ligne 1 : Arial 20 bleu centr√© gras<br>Ligne 2 : Calibri 18 rouge italique<br>Ligne 3 : Verdana 16 vert surlign√©",
"Ligne 1 : Verdana 18 violet italique<br>Ligne 2 : Arial 20 noir gras<br>Ligne 3 : Georgia 16 bleu"
];

function nouvelExercice(){
  document.getElementById("texteARecopier").innerHTML =
    textes[Math.floor(Math.random()*textes.length)];
  document.getElementById("consigneForme").innerHTML =
    "<b>Consigne :</b><br>"+consignes[Math.floor(Math.random()*consignes.length)];
  document.getElementById("editor").innerHTML="<div><br></div>";
}
nouvelExercice();

// STATUS BAR
document.getElementById("editor").addEventListener("click",()=>{
  let sel=window.getSelection();
  if(!sel.rangeCount)return;
  let n=sel.focusNode.nodeType===3?sel.focusNode.parentElement:sel.focusNode;
  let cs=getComputedStyle(n);
  statusBar.textContent=`Police: ${cs.fontFamily} | Taille: ${cs.fontSize} | Couleur: ${cs.color}`;
});
</script>

</body>
</html>
