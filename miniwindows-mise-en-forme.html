<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>MiniWord ‚Äì Exercices de mise en forme</title>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  margin:0;
  font-family:Calibri, Arial;
  background:#eef1f7;
}

/* RUBAN */
#ribbon{
  background:#fff;
  border-bottom:1px solid #cfd6e3;
  padding:6px 10px;
  display:flex;
  gap:10px;
}
.group{display:flex;gap:4px;padding-right:10px;border-right:1px solid #e1e6f0}
.group:last-child{border:none}

button.btn, select.sel{
  height:30px;
  background:#f3f4f7;
  border:1px solid #c6ccd8;
  border-radius:3px;
  cursor:pointer;
  font-size:14px;
}
button.btn:hover{background:#e4ebff}

h1{text-align:center;margin:12px}

.box{
  width:80%;
  margin:10px auto;
  background:#fff;
  padding:16px;
  border-radius:8px;
}

#modele{border:2px solid #4a75f7}
#consigne{border:2px dashed #4a75f7}
#editor{
  min-height:260px;
  border:1px solid #bbb;
}
#editor div{min-height:22px}
mark{background:#fff59d;padding:0 2px}

/* BOUTONS FIN */
#actions{
  text-align:center;
  margin:20px;
  display:none;
}
.actionBtn{
  margin:6px;
  padding:10px 18px;
  border-radius:6px;
  border:none;
  background:#4a75f7;
  color:white;
  cursor:pointer;
}
#statusBar{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  background:#dfe6f5;
  border-top:1px solid #bfc7d6;
  font-size:13px;
  padding:6px 10px;
}
</style>
</head>

<body>

<!-- RUBAN -->
<div id="ribbon">
  <div class="group">
    <button class="btn" onclick="cmd('bold')"><b>B</b></button>
    <button class="btn" onclick="cmd('italic')"><i>I</i></button>
    <button class="btn" onclick="cmd('underline')"><u>U</u></button>
    <button class="btn" onclick="cmd('highlight')">üñç</button>
  </div>

  <div class="group">
    <select class="sel" onchange="cmd('size',this.value)">
      <option>14</option><option>16</option><option>18</option><option>20</option>
    </select>
    <select class="sel" onchange="cmd('color',this.value)">
      <option value="black">Noir</option>
      <option value="blue">Bleu</option>
      <option value="red">Rouge</option>
      <option value="green">Vert</option>
    </select>
  </div>

  <div class="group">
    <select class="sel" onchange="cmd('align',this.value)">
      <option value="left">Gauche</option>
      <option value="center">Centr√©</option>
      <option value="right">Droite</option>
    </select>
  </div>
</div>

<h1>üìù Exercices de mise en forme</h1>

<div class="box" id="modele"></div>
<div class="box" id="consigne"></div>

<div class="box">
<b>J‚Äô√©cris ici :</b>
<div id="editor" contenteditable="true"><div><br></div></div>
</div>

<div id="actions">
  <button class="actionBtn" onclick="exportPDF()">üìÑ T√©l√©charger le PDF</button>
  <button class="actionBtn" onclick="resetAll()">üîÑ R√©initialiser</button>
</div>

<div id="statusBar">Exercice 1 / 5</div>

<script>
// ---------- STYLE ----------
function cmd(type,val=null){
  let s=window.getSelection();
  if(!s.rangeCount||s.isCollapsed)return;
  let r=s.getRangeAt(0);
  let c=r.extractContents();
  let el;

  if(type==="highlight"){
    el=document.createElement("mark");
  }else{
    el=document.createElement("span");
    if(type==="bold") el.style.fontWeight="bold";
    if(type==="italic") el.style.fontStyle="italic";
    if(type==="underline") el.style.textDecoration="underline";
    if(type==="size") el.style.fontSize=val+"px";
    if(type==="color") el.style.color=val;
    if(type==="align"){el.style.display="block";el.style.textAlign=val;}
  }
  el.appendChild(c);
  r.insertNode(el);
}

// ---------- EXERCICES ----------
const exercices=[
{
modele:"Je m‚Äôappelle Alex.<br>Je cherche un emploi.<br>Je suis motiv√©.",
consigne:"Ligne 1 : gras<br>Ligne 2 : italique<br>Ligne 3 : surlign√©"
},
{
modele:"Je travaille en √©quipe.<br>Je respecte les consignes.<br>Je suis ponctuel.",
consigne:"Ligne 1 : bleu<br>Ligne 2 : taille 18<br>Ligne 3 : centr√©"
},
{
modele:"Je pr√©pare mon CV.<br>J‚Äôenvoie ma candidature.<br>J‚Äôattends une r√©ponse.",
consigne:"Ligne 1 : gras + bleu<br>Ligne 2 : italique<br>Ligne 3 : surlign√©"
},
{
modele:"Je commence un nouveau travail.<br>Je suis concentr√©.<br>Je progresse.",
consigne:"Ligne 1 : taille 20<br>Ligne 2 : vert<br>Ligne 3 : centr√©"
},
{
modele:"Je suis autonome.<br>Je sais utiliser Word.<br>Je continue √† apprendre.",
consigne:"Ligne 1 : gras + rouge<br>Ligne 2 : italique + bleu<br>Ligne 3 : surlign√©"
}
];

let index=0;

// ---------- CHARGER ----------
function loadExo(){
  modele.innerHTML="<b>Texte √† recopier :</b><br><br>"+exercices[index].modele;
  consigne.innerHTML="<b>Consigne :</b><br>"+exercices[index].consigne;
  editor.innerHTML=localStorage.getItem("exo"+index)||"<div><br></div>";
  statusBar.textContent=`Exercice ${index+1} / 5`;
  save();
}
loadExo();

// ---------- SAUVEGARDE AUTO ----------
editor.addEventListener("input",()=>save());
function save(){
  localStorage.setItem("exo"+index,editor.innerHTML);
}

// ---------- NAVIGATION ----------
document.addEventListener("keydown",e=>{
  if(e.ctrlKey && e.key==="ArrowRight" && index<4){index++;loadExo();}
  if(e.ctrlKey && e.key==="ArrowLeft" && index>0){index--;loadExo();}
  if(index===4) actions.style.display="block";
});

// ---------- PDF ----------
function exportPDF(){
  const {jsPDF}=window.jspdf;
  let pdf=new jsPDF();
  pdf.text(editor.innerText,10,10);
  pdf.save("exercice_mise_en_forme.pdf");
}

// ---------- RESET ----------
function resetAll(){
  if(!confirm("Tout effacer ?"))return;
  for(let i=0;i<5;i++) localStorage.removeItem("exo"+i);
  index=0;loadExo();
}

// ---------- CORRECTION FORMATEUR ----------
document.addEventListener("keydown",e=>{
  if(e.ctrlKey && e.key==="k"){
    let code=prompt("Code formateur ?");
    if(code==="fide"){
      alert("Correction : v√©rifier couleurs, taille, alignement et surlignement.");
    }
  }
});
</script>

</body>
</html>
