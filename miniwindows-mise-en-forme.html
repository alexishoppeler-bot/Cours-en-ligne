<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>MiniWord ‚Äì Version stable</title>

<style>
body{
  margin:0;
  font-family:Calibri, Arial;
  background:#eef1f7;
}

/* RUBAN */
#ribbon{
  background:#fff;
  border-bottom:1px solid #cfd6e3;
  padding:6px 10px;
  display:flex;
  gap:12px;
}

/* GROUPES */
.group{
  display:flex;
  gap:4px;
  padding-right:12px;
  border-right:1px solid #e1e6f0;
}
.group:last-child{border:none}

/* BOUTONS WORD-LIKE */
.btn{
  min-width:34px;
  height:30px;
  background:#f3f4f7;
  border:1px solid #c6ccd8;
  border-radius:3px;
  cursor:pointer;
  font-size:15px;
}
.btn:hover{background:#e4ebff}
.btn:active{background:#cddcff}

/* SELECTS */
.sel{
  height:30px;
  background:#f3f4f7;
  border:1px solid #c6ccd8;
  border-radius:3px;
}

/* ZONES */
h2{text-align:center;margin:16px 0}

#texteARecopier,#consigneForme,#editor{
  width:80%;
  margin:12px auto;
  padding:16px;
  background:#fff;
  border-radius:6px;
}

#texteARecopier{border:2px solid #4a75f7}
#consigneForme{border:2px dashed #4a75f7}

#editor{
  min-height:320px;
  border:1px solid #bfc7d6;
}
#editor div{min-height:22px}

/* SURIGNEMENT WORD */
mark{
  background:#fff59d;
  padding:0 2px;
}

/* BARRE BAS */
#statusBar{
  position:fixed;
  bottom:0;
  left:0;
  width:100%;
  background:#dfe6f5;
  border-top:1px solid #bfc7d6;
  font-size:13px;
  padding:6px 10px;
}
</style>
</head>

<body>

<!-- RUBAN -->
<div id="ribbon">
  <div class="group">
    <button class="btn" onclick="cmd('bold')"><b>B</b></button>
    <button class="btn" onclick="cmd('italic')"><i>I</i></button>
    <button class="btn" onclick="cmd('underline')"><u>U</u></button>
    <button class="btn" onclick="cmd('highlight')">üñç</button>
  </div>

  <div class="group">
    <select class="sel" onchange="cmd('font',this.value)">
      <option>Arial</option>
      <option selected>Calibri</option>
      <option>Verdana</option>
    </select>

    <select class="sel" onchange="cmd('size',this.value)">
      <option>14</option>
      <option>16</option>
      <option>18</option>
      <option>20</option>
    </select>
  </div>

  <div class="group">
    <select class="sel" onchange="cmd('color',this.value)">
      <option value="black">Noir</option>
      <option value="blue">Bleu</option>
      <option value="red">Rouge</option>
      <option value="green">Vert</option>
    </select>
  </div>
</div>

<h2>MiniWord ‚Äì Copier et mettre en forme</h2>

<div id="texteARecopier"></div>
<div id="consigneForme"></div>

<button onclick="nouvelExercice()" style="margin-left:10%;padding:8px 18px;background:#4a75f7;color:#fff;border:none;border-radius:5px">
üîÑ Nouvel exercice
</button>

<div id="editor" contenteditable="true"><div><br></div></div>

<div id="statusBar">S√©lectionne du texte ‚Üí clique un bouton</div>

<script>
function cmd(type,val=null){
  let sel=window.getSelection();
  if(!sel.rangeCount||sel.isCollapsed)return;
  let r=sel.getRangeAt(0);
  let c=r.extractContents();
  let el;

  if(type==="highlight"){
    el=document.createElement("mark");
  }else{
    el=document.createElement("span");
    if(type==="bold") el.style.fontWeight="bold";
    if(type==="italic") el.style.fontStyle="italic";
    if(type==="underline") el.style.textDecoration="underline";
    if(type==="font") el.style.fontFamily=val;
    if(type==="size") el.style.fontSize=val+"px";
    if(type==="color") el.style.color=val;
  }

  el.appendChild(c);
  r.insertNode(el);
}

const textes=[
"Aujourd‚Äôhui je suis motiv√©.<br>Je veux progresser.<br>Je vais r√©ussir.",
"Je lis la consigne.<br>Je copie le texte.<br>Je respecte la mise en forme."
];

const consignes=[
"Ligne 1 : Gras et bleu<br>Ligne 2 : Italique<br>Ligne 3 : Surlign√©",
"Ligne 1 : Calibri 18<br>Ligne 2 : Rouge<br>Ligne 3 : Surlign√©"
];

function nouvelExercice(){
  texteARecopier.innerHTML=textes[Math.floor(Math.random()*textes.length)];
  consigneForme.innerHTML="<b>Consigne :</b><br>"+consignes[Math.floor(Math.random()*consignes.length)];
  editor.innerHTML="<div><br></div>";
}
nouvelExercice();
</script>

</body>
</html>
