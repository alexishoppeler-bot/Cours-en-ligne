<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tu â†’ Vous â€“ validation pro</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{font-family:Arial;background:#eef3f9;padding:20px}
.container{
  max-width:1100px;margin:auto;background:#fff;padding:30px;
  border-radius:20px;box-shadow:0 6px 25px rgba(0,0,0,.12)
}
h1{text-align:center;color:#004c97}

.consigne{
  background:#f3f7ff;padding:20px;border-radius:16px;
  border-left:6px solid #004c97;margin-bottom:24px
}

.item{
  background:#fff7e6;
  padding:15px;border-radius:14px;margin-bottom:16px
}

textarea{
  width:100%;height:60px;padding:12px;font-size:16px;
  border-radius:12px;border:1px solid #ccc;resize:none;margin-top:6px
}

.row{
  display:flex;justify-content:space-between;align-items:center;margin-top:6px
}

.result{font-size:14px;font-weight:bold}
.ok{color:green}
.ko{color:red}

button{
  padding:10px 16px;border:none;border-radius:14px;
  cursor:pointer;font-size:14px
}
.valider{background:#004c97;color:white}

.actions{
  display:flex;gap:15px;margin-top:25px;flex-wrap:wrap
}

.pdf{background:#2e8b57;color:white}
.reset{background:#ddd}
.formateur{background:#444;color:white}

.score{
  text-align:center;font-size:18px;font-weight:bold;
  margin-top:15px;color:#004c97
}

.saved{
  text-align:center;font-size:13px;color:#2e8b57;margin-top:8px
}
</style>
</head>

<body>

<div class="container">
<h1>ğŸ—£ï¸ Passer de Â« tu Â» Ã  Â« vous Â»</h1>

<div class="consigne">
<b>Consigne â€“ mode examen :</b><br>
Transformez chaque phrase avec <b>tu</b> en phrase professionnelle avec <b>vous</b>.<br>
Changez seulement le pronom et le verbe.
</div>

<div id="liste"></div>

<div class="score" id="score"></div>
<div class="saved" id="savedMsg"></div>

<div class="actions">
  <button class="pdf" onclick="exportPDF()">ğŸ“„ PDF</button>
  <button class="reset" onclick="resetAll()">ğŸ—‘ RÃ©initialiser</button>
  <button class="formateur" onclick="accesFormateur()">ğŸ” Formateur</button>
</div>

</div>

<script>
// ğŸ” code formateur
const CODE_FORMATEUR = "1984";

// âœ… phrases TU
const phrases = [
"Tu peux venir demain.","Tu es disponible cet aprÃ¨s-midi.","Tu arrives en retard.","Tu peux mâ€™appeler.",
"Tu confirmes le rendez-vous.","Tu es bien arrivÃ©.","Tu commences Ã  quelle heure.","Tu peux envoyer le document.",
"Tu es libre demain matin.","Tu as compris le message.","Tu peux travailler demain.","Tu viens Ã  lâ€™entretien.",
"Tu es prÃªt.","Tu peux changer lâ€™horaire.","Tu termines Ã  quelle heure.","Tu es absent aujourdâ€™hui.",
"Tu peux me rÃ©pondre.","Tu es disponible cette semaine.","Tu peux confirmer ta prÃ©sence.","Tu peux attendre un moment.",
"Tu as reÃ§u mon message.","Tu es dâ€™accord.","Tu peux commencer lundi.","Tu es en route.",
"Tu es intÃ©ressÃ© par le poste.","Tu peux me dire quand.","Tu es dÃ©jÃ  passÃ©.","Tu peux venir plus tÃ´t.",
"Tu es motivÃ©.","Tu peux signer le document.","Tu es disponible demain.","Tu as terminÃ© la tÃ¢che.",
"Tu peux rester un peu.","Tu es en pause.","Tu peux revenir plus tard.","Tu es malade aujourdâ€™hui.",
"Tu peux confirmer lâ€™heure.","Tu es bien inscrit.","Tu peux participer Ã  la rÃ©union.",
"Tu es libre cet aprÃ¨s-midi.","Tu rÃ©ponds au message.","Tu peux expliquer la situation.",
"Tu es absent demain.","Tu peux prÃ©venir en cas de retard.",
"Tu es disponible lundi.","Tu peux envoyer un email.",
"Tu es Ã  lâ€™heure.","Tu peux modifier la date.",
"Tu es dâ€™accord avec la proposition.","Tu confirmes ta disponibilitÃ©."
];

// âœ… corrigÃ© VOUS
const solutions = phrases.map(p =>
  p.replace(/^Tu /,"Vous ")
   .replace(" peux "," pouvez ")
   .replace(" es "," Ãªtes ")
   .replace(" arrives "," arrivez ")
   .replace(" confirmes "," confirmez ")
   .replace(" commences "," commencez ")
   .replace(" termines "," terminez ")
   .replace(" as "," avez ")
   .replace(" viens "," venez ")
   .replace(" rÃ©ponds "," rÃ©pondez ")
);

// affichage
const zone = document.getElementById("liste");
let resultats = Array(phrases.length).fill(null);

phrases.forEach((p,i)=>{
  zone.innerHTML += `
  <div class="item">
    <b>${i+1}.</b> ${p}
    <textarea id="r${i}" placeholder="Version avec Â« vous Â»..."></textarea>
    <div class="row">
      <div id="res${i}" class="result"></div>
      <button class="valider" onclick="valider(${i})">Valider</button>
    </div>
  </div>`;
});

// ğŸ’¾ sauvegarde auto
phrases.forEach((_,i)=>{
  const t=document.getElementById("r"+i);
  t.value=localStorage.getItem("r"+i)||"";
  t.addEventListener("input",()=>{
    localStorage.setItem("r"+i,t.value);
    savedMsg.textContent="ğŸ’¾ Sauvegarde automatique";
    setTimeout(()=>savedMsg.textContent="",1200);
  });
});

// âœ… NORMALISATION
function clean(txt){
  return txt.toLowerCase()
    .replace(/[â€™â€˜`Â´]/g, "'")
    .replace(/[â€-â€“â€”âˆ’]/g, "-")
    .replace(/\s+/g, " ")
    .trim();
}

// âœ… validation
function valider(i){
  const user=clean(document.getElementById("r"+i).value);
  const sol=clean(solutions[i]);
  const res=document.getElementById("res"+i);

  if(!user){
    res.textContent="âŒ Vide";res.className="result ko";resultats[i]=false;
  } else if(user===sol){
    res.textContent="âœ… Correct";res.className="result ok";resultats[i]=true;
  } else{
    res.textContent="âŒ Ã€ corriger";res.className="result ko";resultats[i]=false;
  }
  updateScore();
}

function updateScore(){
  const ok=resultats.filter(x=>x===true).length;
  score.textContent=`Score : ${ok} / ${phrases.length}`;
}

// ğŸ” formateur
function accesFormateur(){
  const code=prompt("Code formateur :");
  if(code!==CODE_FORMATEUR){alert("Code incorrect");return;}
  phrases.forEach((_,i)=>{
    document.getElementById("r"+i).value=solutions[i];
    resultats[i]=true;
    document.getElementById("res"+i).textContent="âœ… CorrigÃ©";
    document.getElementById("res"+i).className="result ok";
  });
  updateScore();
}

// ğŸ“„ PDF
function exportPDF(){
  const { jsPDF } = window.jspdf;
  const pdf=new jsPDF();
  let y=20;
  phrases.forEach((_,i)=>{
    pdf.text(`${i+1}. ${document.getElementById("r"+i).value||""}`,15,y);
    y+=10;if(y>270){pdf.addPage();y=20;}
  });
  pdf.save("tu_vers_vous.pdf");
}

// ğŸ”„ reset
function resetAll(){
  if(confirm("Tout effacer ?")){
    phrases.forEach((_,i)=>{
      localStorage.removeItem("r"+i);
      document.getElementById("r"+i).value="";
      document.getElementById("res"+i).textContent="";
      resultats[i]=null;
    });
    score.textContent="";
  }
}
</script>

</body>
</html>
